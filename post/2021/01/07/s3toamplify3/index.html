<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,minimum-scale=1"><title>Amplifyを使って、Hugoで作成したWebページを公開する(3) - 気まぐれ気紛れ草紙</title><style type=text/css>img.wp-smiley,img.emoji{display:inline!important;border:none!important;box-shadow:none!important;height:1em!important;width:1em!important;margin:0 .07em!important;vertical-align:-.1em!important;background:0 0!important;padding:0!important}</style><link rel=icon type=image/vnd.microsoft.icon href=/favicon.ico><link rel=stylesheet href=/css/style.css type=text/css media=all><link rel=stylesheet href=/css/custom.css type=text/css media=all><link rel=stylesheet href=/css/syntax.css type=text/css media=all><link rel=stylesheet href=/css/toc.css type=text/css media=all><meta property="og:title" content="Amplifyを使って、Hugoで作成したWebページを公開する(3)"><meta property="og:description" content="はじめに
前回の記事で、HugoプロジェクトをGitHubにアップロードしました。今回は、AWS Amplifyを使って、Hugoで作成したWebページを公開するところまで整理したいと思います。
第1回の記事でも書きましたが、従来はS3のWebホスティング機能とRoute53を利用していました。この手法ではWebページのHTTPS化に対応することが容易ではないため、Amplifyを使うことに決めました。
今回の作業では、Amazon Web Services（AWS）のアカウントが取得済みであることと、独自ドメインがAWSのRoute53の管理下に置かれていることを前提に進めます。"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.rkarsnk.jp/post/2021/01/07/s3toamplify3/"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-01-07T18:22:07+09:00"><meta property="article:modified_time" content="2021-01-07T18:22:07+09:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Amplifyを使って、Hugoで作成したWebページを公開する(3)"><meta name=twitter:description content="はじめに
前回の記事で、HugoプロジェクトをGitHubにアップロードしました。今回は、AWS Amplifyを使って、Hugoで作成したWebページを公開するところまで整理したいと思います。
第1回の記事でも書きましたが、従来はS3のWebホスティング機能とRoute53を利用していました。この手法ではWebページのHTTPS化に対応することが容易ではないため、Amplifyを使うことに決めました。
今回の作業では、Amazon Web Services（AWS）のアカウントが取得済みであることと、独自ドメインがAWSのRoute53の管理下に置かれていることを前提に進めます。"></head><body class=two-column><a href=#content>Skip to content</a><div class=wrapper><header role=banner class="banner widgets columns-1"><a href=/ rel=home><h1 class=site>気まぐれ気紛れ草紙</h1><p></p></a><nav role=navigation aria-label="Primary Navigation"><ul class=menu><li class=menu-item><a class=menu__link href=/>Home</a></li><li class=menu-item><a class=menu__link href=/about>About</a></li></ul><select onchange="location.href=value"><option value=/ class="menu-item menu-item-type-custom menu-item-object-custom">Home</option><option value=/about class="menu-item menu-item-type-custom menu-item-object-custom">About</option></select></nav></header><div id=content class=content><main role=main><article role=article class="post type-post format-standard hentry"><header class=post-header><h1>Amplifyを使って、Hugoで作成したWebページを公開する(3)</h1><div class=post-details><a rel=bookmark><time datetime=2021-01-07T17:622:76>2021-01-07</time></a>
<span style=float:right><div id=fb-root style=height:100%></div><script async defer crossorigin=anonymous src="https://connect.facebook.net/ja_JP/sdk.js#xfbml=1&version=v3.2"></script><div class=fb-share-button data-href=https://blog.rkarsnk.jp/post/2021/01/07/s3toamplify3/ data-layout=button_count data-size=small><a target=_blank href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.rkarsnk.jp%2fpost%2f2021%2f01%2f07%2fs3toamplify3%2f" class=fb-xfbml-parse-ignore>Share</a></div>&nbsp;
<a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class=twitter-share-button data-text=Amplifyを使って、Hugoで作成したWebページを公開する(3) data-url=https://blog.rkarsnk.jp/post/2021/01/07/s3toamplify3/ data-show-count=false>Tweet</a>
<script async src=https://platform.twitter.com/widgets.js></script>
&nbsp;
<a href="http://b.hatena.ne.jp/add?mode=confirm&url=https%3a%2f%2fblog.rkarsnk.jp%2fpost%2f2021%2f01%2f07%2fs3toamplify3%2f&title=Amplify%e3%82%92%e4%bd%bf%e3%81%a3%e3%81%a6%e3%80%81Hugo%e3%81%a7%e4%bd%9c%e6%88%90%e3%81%97%e3%81%9fWeb%e3%83%9a%e3%83%bc%e3%82%b8%e3%82%92%e5%85%ac%e9%96%8b%e3%81%99%e3%82%8b%283%29" class=hatena-bookmark-button data-hatena-bookmark-layout=basic-counter><img src=https://b.st-hatena.com/images/v4/public/entry-button/button-only@2x.png width=20 height=20 style=border:none></a>
<script type=text/javascript src=https://b.st-hatena.com/js/bookmark_button.js async></script></span></div></header><div class=post-content><h1 id=はじめに>はじめに</h1><p><a href=https://blog.rkarsnk.jp/post/2021/01/02/s3toamplify2/>前回の記事</a>で、HugoプロジェクトをGitHubにアップロードしました。今回は、<a href=https://aws.amazon.com/jp/amplify/>AWS Amplify</a>を使って、Hugoで作成したWebページを公開するところまで整理したいと思います。</p><p><a href=https://blog.rkarsnk.jp/post/2020/12/31/s3toamplify/>第1回の記事</a>でも書きましたが、従来はS3のWebホスティング機能とRoute53を利用していました。この手法ではWebページのHTTPS化に対応することが容易ではないため、Amplifyを使うことに決めました。</p><p>今回の作業では、Amazon Web Services（AWS）のアカウントが取得済みであることと、独自ドメインがAWSのRoute53の管理下に置かれていることを前提に進めます。</p><div class=toc-box><div class=toc-label>目次</div><div class=toc-chapter><nav id=TableOfContents><ul><li><a href=#はじめに>はじめに</a></li><li><a href=#aws-amplifyを使ってwebページを公開する>AWS Amplifyを使って、Webページを公開する</a><ul><li><a href=#想定要件>想定要件</a></li><li><a href=#aws-amplifyでのデプロイ>AWS Amplifyでのデプロイ</a></li><li><a href=#デプロイされたwebページを独自ドメインで公開する>デプロイされたWebページを独自ドメインで公開する</a></li><li><a href=#動作確認>動作確認</a></li></ul></li><li><a href=#おわりに>おわりに</a></li></ul></nav></div></div><h1 id=aws-amplifyを使ってwebページを公開する>AWS Amplifyを使って、Webページを公開する</h1><h2 id=想定要件>想定要件</h2><p>以下の要件を想定して、整理します。</p><table><thead><tr><th>項目名</th><th>要件</th></tr></thead><tbody><tr><td>Hugoプロジェクト名</td><td>study-hugo</td></tr><tr><td>GitHubリポジトリ名<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></td><td>study-hugo</td></tr><tr><td>公開用のURL<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup></td><td><a href=https://study.rkarsnk.jp/>https://study.rkarsnk.jp/</a></td></tr><tr><td>Hugo用テーマ</td><td><a href=https://github.com/tosi29/inkblotty>inkblotty</a></td></tr><tr><td>AWSのリージョン<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup></td><td>東京リージョン</td></tr></tbody></table><h2 id=aws-amplifyでのデプロイ>AWS Amplifyでのデプロイ</h2><p>AWSが提供しているサービスは多数あるため、目的のサービス名がはっきりしている場合は、サービス名で検索することをオススメします。</p><p>図1のように、検索欄に「Amplify」と入力すると、サービスのメニューが表示されます。</p><figure><img src=/images/s3toamplify/amplify.png width=650><figcaption><h4>図1 Amplifyを検索</h4></figcaption></figure><p>「AWS Amplify」を選択して、Amplify コンソールを開きます。</p><p>図2の画面からは、すでに一つのWebページ（このblogです）がデプロイされていることが分かります。</p><p>Amplifyでは、デプロイするアプリケーションに関して、Host Web Appと App backendの2種類が提供されています。Hugoを利用したWebページはHost Web Appを使用してデプロイします。</p><figure><img src=/images/s3toamplify/amplify01.png width=650><figcaption><h4>図2 Amplify コンソール</h4></figcaption></figure><p>右上のNew appから「Host web app」を選択します。</p><p>デプロイしたいWebページのソースコードが置いたるリポジトリサービスを選択します。ここでは、GitHubを選択します。AmplifyとGitHubの連携が初めての場合、サービス間連携の許可を求めるメッセージと共にGitHubの認証情報が求められます。</p><figure><img src=/images/s3toamplify/amplify02.png width=650><figcaption><h4>図3 リポジトリサービスの選択</h4></figcaption></figure><p>GitHubとの連携が完了したら、デプロイするリポジトリとブランチを選択します。ここでは一覧から「study-hugo」を選択します。また、ブランチ名はmainを指定します。</p><figure><img src=/images/s3toamplify/amplify03.png width=650><figcaption><h4>図4 リポジトリブランチの選択</h4></figcaption></figure><p>リポジトリブランチの設定が完了すると、ビルド設定の構成を行います。</p><p>図5のように、Hugoプロジェクト用のビルド設定が自動的に設定されます。</p><figure><img src=/images/s3toamplify/amplify04.png width=650><figcaption><h4>図5 ビルド設定の構成</h4></figcaption></figure><p>このままでは、ビルド時にgit submoduleで追加したinkblottyテーマのソースコードが取得されないため、以下のようにビルドスクリプトを修正します。ビルドスクリプトの修正後、「次へ」を選択します。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>frontend</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>phases</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>build</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>commands</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=l>git submodule update</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=l>hugo</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>artifacts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>baseDirectory</span><span class=p>:</span><span class=w> </span><span class=l>public</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>files</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s1>&#39;**/*&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>cache</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>paths</span><span class=p>:</span><span class=w> </span><span class=p>[]</span><span class=w>
</span></span></span></code></pre></div><p>図5の確認画面で内容に問題なければ、「保存してデプロイ」を選択してデプロイを開始します。デプロイ作業には数分かかります。</p><figure><img src=/images/s3toamplify/amplify05.png width=650><figcaption><h4>図5 確認</h4></figcaption></figure><p>作業の進捗は、図6のように表示され、プロビジョンから検証までの工程が完了すれば、デプロイ作業が完了します。</p><figure><img src=/images/s3toamplify/amplify06.png width=650><figcaption><h4>図6 デプロイ完了</h4></figcaption></figure><h2 id=デプロイされたwebページを独自ドメインで公開する>デプロイされたWebページを独自ドメインで公開する</h2><p>Amplifyでデプロイされた直後は、<code>https://main.xxxxxxxx.amplifyapp.com</code>のURLが設定されています。カスタムドメインの設定をすることで、公開用の独自ドメインを含むURLで公開することができます。</p><p>アプリの設定カテゴリから「ドメイン管理」を選択します。図7の画面が表示されるので、右上の「カスタムドメインの追加」を選択します。</p><figure><img src=/images/s3toamplify/amplify07.png width=650><figcaption><h4>図7 ドメイン管理</h4></figcaption></figure><p>図8のカスタムドメインの追加画面が表示されます。
ルートドメインに自分が管理するドメインを入力し、サブドメインの設定欄で<code>Exclude Root</code>を設定し、study.rkarsnk.jpがmainになるように設定します。</p><figure><img src=/images/s3toamplify/amplify08.png width=650><figcaption><h4>図8 カスタムドメインの追加</h4></figcaption></figure><p>保存を選択すると、カスタムドメイン設定の処理が自動的に進みます。処理内容としては、SSL証明書の発行、AWS CloudFrontの設定、Route53へのサブドメインの登録が行われます。</p><p>この処理には少し時間かかるため、コーヒーでも飲んで一服してください。</p><figure><img src=/images/s3toamplify/amplify09.png width=650><figcaption><h4>図9 カスタムドメイン設定の進捗確認(1)</h4></figcaption></figure><p>図10のように、Custom DomainのStatusがAvailableになれば完了です。</p><figure><img src=/images/s3toamplify/amplify10.png width=650><figcaption><h4>図10 カスタムドメイン設定の進捗確認(2)</h4></figcaption></figure><h2 id=動作確認>動作確認</h2><p>ブラウザを使用して、公開用URLにアクセスします。図11のようにWebページにアクセスできるようになりました。</p><figure><img src=/images/s3toamplify/amplify11.png width=650><figcaption><h4>図11 公開後のページ</h4></figcaption></figure><p>以上で、Hugoで作成したWebページを公開するための作業が完了となります。</p><h1 id=おわりに>おわりに</h1><p>３回にわけて、AWS Amplifyを使って、Hugoで作成したWebページを公開する作業について整理しました。</p><p>最後まで読んでいただきありがとうございます。</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>GitHubアカウントは作成済み。&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>ドメインは取得済み。&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p>AWSアカウントは作成済み。&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><footer class=post-footer><span class=post-categories><a href=https://blog.rkarsnk.jp/categories/%E6%8A%80%E8%A1%93%E7%B3%BB/>技術系</a>&emsp;</span>
<span class=post-tags><a href=https://blog.rkarsnk.jp/tags/amazon-web-services/>Amazon Web Services</a>&emsp;
<a href=https://blog.rkarsnk.jp/tags/amplify/>Amplify</a>&emsp;
<a href=https://blog.rkarsnk.jp/tags/github/>GitHub</a>&emsp;
<a href=https://blog.rkarsnk.jp/tags/hugo/>Hugo</a>&emsp;</span></footer><table cellspacing=15 style=width:100%;border:none><tr><td style=text-align:center;border:none;padding:0></td><td style=text-align:center;border:none;padding:0></td></tr></table><h4>関連記事</h4><ol style=margin-left:30px;list-style-type:decimal><li><strong><a href=/post/2021/01/02/s3toamplify2/>Amplifyを使って、Hugoで作成したWebページを公開する(2)</a></strong></li><li><strong><a href=/post/2020/12/31/s3toamplify/>Amplifyを使って、Hugoで作成したWebページを公開する(1)</a></strong></li></ol></article><script type=application/javascript src=/js/code.js></script>
<link rel=stylesheet href=/css/code.css type=text/css media=all><nav class="navigation post-navigation" role=navigation><div class=nav-links><div class=nav-previous><a class=previous href=https://blog.rkarsnk.jp/post/2021/01/02/s3toamplify2/>Amplifyを使って、Hugoで作成したWebページを公開する(2)</a></div><div class=nav-next><a class=next href=https://blog.rkarsnk.jp/post/2021/12/10/debugefiapp/>UEFIアプリケーションをデバッグする</a></div></div></nav><section><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//blog-rkarsnk-jp.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></section></main><div class="sidebar1 widgets columns-1"><aside></aside><aside class="widget widget_categories"><h2>カテゴリ</h2><ul class=widget__list><li class="cat-item cat-item-2"><a href=https://blog.rkarsnk.jp/categories/debian/>Debian (2)</a></li><li class="cat-item cat-item-2"><a href=https://blog.rkarsnk.jp/categories/%E6%8A%80%E8%A1%93%E7%B3%BB/>技術系 (4)</a></li><li class="cat-item cat-item-2"><a href=https://blog.rkarsnk.jp/categories/%E6%97%A5%E8%A8%98/>日記 (1)</a></li></ul></aside><aside class="widget widget_tag_cloud"><h2>タグ</h2><div class=tagcloud><a class=tag-cloud-link href=https://blog.rkarsnk.jp/tags/amazon-web-services/ title=amazon-web-services style=font-size:12pt>Amazon Web Services</a>&emsp;<a class=tag-cloud-link href=https://blog.rkarsnk.jp/tags/amplify/ title=amplify style=font-size:12pt>Amplify</a>&emsp;<a class=tag-cloud-link href=https://blog.rkarsnk.jp/tags/bullseye/ title=bullseye style=font-size:12pt>bullseye</a>&emsp;<a class=tag-cloud-link href=https://blog.rkarsnk.jp/tags/debian/ title=debian style=font-size:12pt>Debian</a>&emsp;<a class=tag-cloud-link href=https://blog.rkarsnk.jp/tags/diary/ title=diary style=font-size:12pt>Diary</a>&emsp;<a class=tag-cloud-link href=https://blog.rkarsnk.jp/tags/github/ title=github style=font-size:12pt>GitHub</a>&emsp;<a class=tag-cloud-link href=https://blog.rkarsnk.jp/tags/hugo/ title=hugo style=font-size:12pt>Hugo</a>&emsp;<a class=tag-cloud-link href=https://blog.rkarsnk.jp/tags/ovmf/ title=ovmf style=font-size:12pt>OVMF</a>&emsp;<a class=tag-cloud-link href=https://blog.rkarsnk.jp/tags/uefi/ title=uefi style=font-size:12pt>UEFI</a>&emsp;<a class=tag-cloud-link href=https://blog.rkarsnk.jp/tags/wine/ title=wine style=font-size:12pt>Wine</a>&emsp;<a class=tag-cloud-link href=https://blog.rkarsnk.jp/tags/%E8%87%AA%E4%BD%9Cos/ title=自作os style=font-size:12pt>自作OS</a>&emsp;</div></aside><aside class="widget widget_recent_entries"><h2>最近の投稿</h2><ul><li><a href=/post/2022/03/25/diary20220325/>2022年3月25日</a></li><li><a href=/post/2022/01/08/wine00/>Debian 11 BullseyeにWineをインストールする vol.1</a></li><li><a href=/post/2022/01/02/memo/>Debian 11 に関係する自分用メモ</a></li><li><a href=/post/2021/12/10/debugefiapp/>UEFIアプリケーションをデバッグする</a></li><li><a href=/post/2021/01/07/s3toamplify3/>Amplifyを使って、Hugoで作成したWebページを公開する(3)</a></li><li><a href=/post/2021/01/02/s3toamplify2/>Amplifyを使って、Hugoで作成したWebページを公開する(2)</a></li><li><a href=/post/2020/12/31/s3toamplify/>Amplifyを使って、Hugoで作成したWebページを公開する(1)</a></li></ul></aside><aside class="widget widget_archive"><h2>アーカイブ</h2><ul><li><a href=https://blog.rkarsnk.jp/archives/2020/12/>2020/12 (1)</a></li><li><a href=https://blog.rkarsnk.jp/archives/2021/01/>2021/01 (3)</a></li><li><a href=https://blog.rkarsnk.jp/archives/2021/12/>2021/12 (1)</a></li><li><a href=https://blog.rkarsnk.jp/archives/2022/03/>2022/03 (1)</a></li></ul></aside></div></div></div><footer role=contentinfo class="document-footer contentinfo widgets columns-1"><aside class="widget widget_text"><div class=textwidget><p>© 気まぐれ気紛れ草紙 / Powered by <a href=https://gohugo.io target=_blank>Hugo</a> with theme <a href=https://github.com/tosi29/inkblotty target=_blank>Inkblotty</a></p></div></aside></footer></div></body></html>